# React的路由

```bash
npm i -S react-router-dom
```



## 一、什么是路由？

- 一个路由就是一个映射关系（`key: value`）
- `key` 为路由路径，`value` 可能是 `function / component`





## 二、路由分类

- 后台路由：`node` 服务器端路由，`value` 是 `function` 用来处理客户端提交的请求并返回一个响应数据。
- 前台路由：浏览器端路由，`value` 是 `component`，当请求的路由是 `path` 时，浏览器端不会发送 `http` 请求，但界面会更新显示对应的组件。



## 三、后端路由

- 注册路由：`router.get(path, function(req, res))`
- 当 `node` 接收到一个请求时，根据请求路径找到匹配的路由，调用路由中的函数来处理请求，返回响应的数据





## 四、前端路由

- 注册路由：`<Route path="/about" component={About} />`
- 当浏览器的 `hash` 变为 `#about` 时，当前路由组件就会变为 `About` 组件



### 1. 路由有哪些

- `<BrowerRouter>`
- `<HashRouter>`
- `<Route>`
- `<Redirect>`
- `<Link>`
- `<NavLink>`



 **`Link` 和 `NavLink` 的区别**

`NavLink` 比 `Link` 在激活相应路由的时候，会多加一个 `active` 类



### 2. Route、Navigate、NavLink、Link

```jsx
import React from 'react';
import { Navigate, Routes, NavLink, Route } from 'react-router-dom';
import About from './About';
import Home from './Home';

class App extends React.Component {
  constructor(props) {
    super(props);
  }

  render() {
    return (
      <div>
        <div className='link-list'>
          <NavLink to="/about">About</NavLink>
          <NavLink to="/home">Home</NavLink>
        </div>
        <div className="body">
          <Routes>
            <Route path='/about' element={<About />} />
            <Route path='/home' element={<Home />} />
            {/* react-router v5版本使用方式 */}
            {/* <Redirect to="/home" /> */}
            {/* v6版本：使用Navigate */}
            <Route path='/' element={<Navigate to="/about" replace />}></Route>
          </Routes>
        </div>
      </div>
    );
  }
}

export default App;
```



### 3. 嵌套路由

```jsx
// app.jsx
<div>
  <div className='link-list'>
    <NavLink to="/about">About</NavLink>
    <NavLink to="/home">Home</NavLink>
  </div>
  <div className="body">
    <Routes>
      <Route path='/about' element={<About />} />
      {/* home发生嵌套 */}
      <Route path='/home/*' element={<Home />} />
      <Route path='/' element={<Navigate to="/about" replace />}></Route>
    </Routes>
  </div>
</div>
```

```jsx
// home.jsx
<div>
<h2>home组件的内容</h2>
<div>
  <ul>
    <li>
      <NavLink to="/home/news">News</NavLink>
    </li>
    <li>
      <NavLink to="/home/message">Message</NavLink>
    </li>
  </ul>
</div>
<Routes>
  <Route path='news' element={<News />}></Route>
  <Route path='message' element={<Message />}></Route>
  <Route path="*" element={<Navigate to ="/home/news" />}/>
</Routes>
</div>
```



### 4. 三级路由和动态传参

```jsx
// index.jsx
<NavLink to="/about">About</NavLink>
<NavLink to="/home">Home</NavLink>

<Routes>
  <Route path='/about' element={<About />} />
  <Route path='/home/*' element={<Home />} />
</Routes>
```

```jsx
// Home.jsx
<NavLink to="/home/news">News</NavLink>
<NavLink to="/home/message">Message</NavLink>

<Routes>
  <Route path='news' element={<News />}></Route>
  <Route path='message/*' element={<Message />}></Route>
</Routes>
```

```jsx
// Message.jsx
import React from 'react';
import { Route, Routes, Link, useParams } from 'react-router-dom';

class Message extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      messages: [
        { id: 1, title: 'vue' },
        { id: 2, title: 'react' },
        { id: 3, title: 'node' },
      ],
    };
  }

  render() {
    const { messages } = this.state;
    const show = messages.length ? 'none' : 'block';

    return (
      <div>
        <p style={{ display: show }}>loading......</p>
        <ul>
          {
            messages.map((message, index) => (
              <li key={index}>
                <Link to={`/home/message/${message.id}`}>{message.title}</Link>
              </li>
            ))
          }
        </ul>
        <Routes>
          <Route path=":id"  element={<MessageDetail />}></Route>
        </Routes>
      </div>
    );
  }
}

const messageDetail = [
  { id: '1', title: '消息1', content: '我是消息1' },
  { id: '2', title: '消息2', content: '我是消息2' },
  { id: '3', title: '消息3', content: '我是消息3' },
];
function MessageDetail() {
  const { id } = useParams();
  const item = messageDetail.find(v => v.id === id);
  return (
    <ul>
      <li>id: {item.id}</li>
      <li>title: {item.title}</li>
      <li>content: {item.content}</li>
    </ul>
  );
}
```

































