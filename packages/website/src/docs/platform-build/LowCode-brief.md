# 低代码（low-code）

首先我们了解一下什么是低代码。

> 低代码（Low-Code Development，LCD）开发者主要通过图形化用户界面和配置来创建应用软件，而不是像传统模式那样主要依靠手写代码。低代码开发模式的开发者，通常不需要具备非常专业的编码技能，或者不需要某一专门领域的编码技能，而是可以通过平台的功能和约束来实现专业代码的产出。

​		实际上，一个可用的低代码平台的搭建并非难事。首先，我们需要明确，低代码平台解决的最大问题是复用，复用也是目前前端开发中的一个重要课题，特别是当前的主流前端js框架，例如 **vue**，**react** 等，都是组件化的开发方式，又如形形色色的ui组件库的出现，像 **ant-design**， **element** 等都是来解决重复造轮子的问题。



## 简易版的低代码平台

​		我们在前端开发脚手架中，通常会创建一些通用的组件，然后在各个需要这个组件的地方进行引用，来提示开发效率。在脚手架中引用一些ui组件库也是出于这样的目的。后来，为了防止重复的造轮子，我们通常会对一些成熟的ui组件库中组件根据我们的业务需要进行二次封装，形成一个具有更多功能的区块，例如B端系统中最为常见的列表数据增删改查界面就是这样一个区块。

<img src=".\assets\low-code-table.png" alt="low-code-table" />



​		我们可以通过一个json数据来描述这个区块，数据大概是下图所示的样子，包含了这个区块的编码，中文名称，以及可传入到这个区块中的属性及初始属性值，例如这个表格包含的列信息、按钮信息等等。而这个json也是低代码平台搭建中最为核心的部分，它在后续介绍的可视化拖拉拽页面设计中扮演极其重要的角色，它是页面设计和页面渲染间串联的纽带。

```json
{
  code: "SearchTable",
  name: "搜索表格",
  props: {
    columns: [
      {
        name: "name",
        desc: "姓名",
        formType: "input",
        isSearch: true
      },
      {
        name: "age",
        desc: "年龄",
        formType: "numberInput"
      }
    ],
    buttons: [
      {
        name: "add",
        desc: "新增"
      }
    ]
  }
}
```

​		当我们展示类似的界面时，只需要在页面文件中引用这个搜索表格模板组件，再把对应的描述json信息传递到组件内就可以了。但是这样似乎还是采用了编码的方式去解决复用问题，距离我们的低代码还有些距离。

​		这时，我们可以将这些可动态控制的组件属性通过在线表单进行填写，存储到数据库中。前端工程中，我们可以进行判断，将使用这个区块模板的页面路由所对应的组件都指向我们封装好的列表增删改查模板。这样，进入到这个页面，我们只需要将之前存储到数据库的区块描述信息通过api接口获取到，再传递到组件内部，将json数据中我们设置的模板属性值赋值到组成模板的各个组件上就可以完成这个模板的渲染了。这也是我们在实现可视化拖拉拽低代码平台之前所使用的方式。这种方式虽然形式上非常简单，却解决了我们组件复用的问题，并且在调整组件属性时只需要通过在线的表单配置，无需打包、发版。这个界面渲染的流程便是低代码平台的核心逻辑：通过组件元数据拼装成一个页面的描述信息，然后通过渲染器组件将描述信息转化页面dom元素。

<img src=".\assets\low-code-table1.png" alt="low-code-table" />

我们上面实现的流程除了图形化的配置外，基本可以通过在平台上界面的配置实现一个搜索表格页面的开发了，并且不需要专业的编码技能。

当然，上面的过程中所使用到的模板实际是我们预设好的，只是通过我们传递进去固定属性的不同属性值进行一些差异化的渲染，一些按钮等自定义功能的扩展也只能通过插槽等形式去实现。但当我们想要实现其它模板的界面时，就显得无能为力了，因为组成模板的组件是我们提前预设好的，并不是通过组件像搭积木一样灵活搭建的。



## 页面设计器

<img src=".\assets\lowcode1.png" alt="low-code-table" />

可以看到，大多数页面设计器都包含了如下所示的几个区域：

- 最上方是**操作栏**，我们可进行页面的保存、预览、查看json信息、查看代码等操作；
- 左侧是**组件列表**，当然也可以添加一些切换，让我们的左侧区域支持查看页面树信息、配置数据源等其他操作；
- 中间是**画布**区域，我们可以将左侧的组件拖动到画布中，当然也支持画布中组件的赋值、删除等操作；
- 右侧是**属性配置**区域，当我们在画布中选中某个组件时，可以在右侧的属性配置区域罗列出当前组件可支持动态配置的属性，修改了属性后可以在画布中看到对应组件的样式变化。

下面，我们按上述的区域划分来看一下页面设计器区域都是如何实现的。



### 组件列表

首先，我们来看一下左侧的组件列表，列表中的每个组件，我们都需要使用一段`json`来进行描述，这段`json`我们将它称之为 **元数据**，元数据中描述了当前组件的中文名称，在列表中显示的图标及描述，和组件可进行配置的一些动态属性。我们以输入框组件为例，它的元数据大致可以定义为如下的样子：







